*n_lev = lev.size();       # Calculate the number of levels
O3_med[$lev] = 0.0;        # Initialize the O3_med variable to zeros

# Loop over levels (i) to calculate the median for the first time step (time index 0) for each level
for (*i = 0; i < n_lev; ++i) {
    *sorted = O3(0,i,0,0);   # Extract the 'O3' values for the first time step (time index 0) and current level
    *med = sorted.size() / 2;  # Calculate the index of the median for the current level
    O3_med(i) = (sorted(*med + 1) + sorted(*med) + sorted(*med - 1)) / 3.0;  # Calculate and store the median for the current level
}