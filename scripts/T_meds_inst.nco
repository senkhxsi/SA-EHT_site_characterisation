*n_lev = lev.size();       # Calculate the number of levels
T_med[$lev] = 0.0;        # Initialize the T_med variable to zeros

# Loop over levels (i) to calculate the median for each level
for (*i = 0; i < n_lev; ++i) {
    *sorted = T(0,i,0,0);   # Extract the 'T' values for the first time step and current level
    *med = sorted.size() / 2;  # Calculate the index of the median for the current level
    T_med(i) = sorted(*med);  # Calculate and store the median for the current level
}